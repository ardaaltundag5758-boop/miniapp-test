<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Flashy App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { 
            --bg: #000000; 
            --card: #111111; 
            --gold: #FFD700;
            --gray: #666666; 
            --nav-red: #FF3B30;
            --premium-blue: #007AFF;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg); color: #fff; font-family: 'Inter', -apple-system, sans-serif; overflow: hidden; width: 100%; height: 100vh; }

        /* AÃ‡ILIÅž EKRANI (INTRO) */
        #intro-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1a0505 0%, #000 100%);
            z-index: 9999; display: flex; flex-direction: column; align-items: center;
            justify-content: center; padding: 30px; text-align: center;
        }
        .intro-avatar { width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--nav-red); margin-bottom: 15px; object-fit: cover; }
        .intro-level { background: var(--nav-red); color: #fff; padding: 4px 12px; border-radius: 50px; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; margin-bottom: 30px; }
        .intro-age { color: var(--gray); font-size: 1.1rem; margin-bottom: 5px; }
        .intro-points { font-size: 4rem; font-weight: 900; margin-bottom: 40px; color: #fff; text-shadow: 0 0 20px rgba(255,255,255,0.2); }
        .intro-btn { 
            width: 80%; background: #fff; color: #000; border: none; padding: 18px; 
            border-radius: 20px; font-weight: 800; font-size: 1.1rem; cursor: pointer; transition: 0.3s;
        }
        
        /* PREMIUM DURUM EKRANI */
        #premium-status-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 10000; display: none; flex-direction: column;
            align-items: center; justify-content: center; padding: 30px; text-align: center;
        }
        .prem-icon { font-size: 4rem; margin-bottom: 20px; }
        .prem-msg { font-size: 1.2rem; color: #fff; margin-bottom: 30px; line-height: 1.5; font-weight: 600; }

        /* ANA UYGULAMA YAPISI (GÄ°ZLÄ° BAÅžLAR) */
        #main-app { display: none; }
        .tab-content { display: none; height: calc(100vh - 70px); overflow-y: auto; padding: 20px 20px 100px 20px; }
        .tab-content.active { display: flex; flex-direction: column; }

        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 70px;
            background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(10px);
            display: grid; grid-template-columns: repeat(2, 1fr); border-top: 1px solid #1a1a1a; z-index: 1000;
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px; color: var(--gray); font-size: 0.75rem; font-weight: 600; }
        .nav-item.active { color: #fff; }
        .nav-item.active::after { content: ""; position: absolute; bottom: 8px; width: 20px; height: 3px; background: var(--nav-red); border-radius: 10px; }

        /* PROFIL ALANI (HOME) */
        .welcome-header { text-align: center; margin-top: 20px; margin-bottom: 40px; }
        .avatar-main { width: 85px; height: 85px; border-radius: 50%; border: 2px solid var(--nav-red); padding: 3px; margin-bottom: 15px; object-fit: cover; }
        .user-info-wrapper { display: flex; align-items: center; justify-content: center; gap: 8px; }
        .rank-badge { font-size: 0.65rem; font-weight: 800; text-transform: uppercase; padding: 3px 8px; border-radius: 6px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.05); }
        .score-card { background: linear-gradient(145deg, #161616, #0a0a0a); border-radius: 30px; padding: 30px; text-align: center; margin-bottom: 20px; border: 1px solid #222; }
        .score-value { font-size: 3.5rem; font-weight: 900; letter-spacing: -2px; }
        .stat-box { background: var(--card); border-radius: 20px; padding: 20px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .rank-diamond { border-color: #b9f2ff; color: #b9f2ff; }
    </style>
</head>
<body>

<div id="intro-screen">
    <img id="intro-pic" class="intro-avatar" src="https://cdn-icons-png.flaticon.com/512/149/149071.png">
    <div id="intro-user-name" style="font-weight: 700; margin-bottom: 5px;">User</div>
    <div id="intro-rank" class="intro-level">Apprentice</div>
    <div class="intro-age" id="intro-age-text">... years on Telegram</div>
    <div class="intro-points" id="intro-points-text">0</div>
    <button class="intro-btn" onclick="showPremiumStep()">Continue</button>
</div>

<div id="premium-status-screen">
    <div id="prem-icon" class="prem-icon"></div>
    <div id="prem-msg" class="prem-msg"></div>
    <button class="intro-btn" style="background: var(--nav-red); color: #fff;" onclick="finishIntro()">End</button>
</div>

<div id="main-app">
    <div id="home" class="tab-content active">
        <div class="welcome-header">
            <img id="u-pic" class="avatar-main" src="https://cdn-icons-png.flaticon.com/512/149/149071.png">
            <div class="user-info-wrapper">
                <span id="u-rank" class="rank-badge">...</span>
                <h2 id="u-name" style="font-size: 1.4rem;">User</h2>
            </div>
        </div>
        <div class="score-card">
            <div class="score-value" id="total-flsy">0</div>
            <div style="color: var(--gray); font-size: 0.9rem;">Total FLSY Points</div>
        </div>
        <div class="stat-box">
            <div><div style="color: var(--gray); font-size: 0.8rem;">Account Age</div><div id="acc-age" style="font-weight: 700;">... years</div></div>
            <i class="fas fa-calendar-alt" style="color: var(--nav-red);"></i>
        </div>
        <div id="prem-stat-box" class="stat-box" style="display: none;">
            <div><div style="color: var(--gray); font-size: 0.8rem;">Telegram Premium</div><div style="font-weight: 700; color: var(--premium-blue);">Active</div></div>
            <i class="fas fa-check-circle" style="color: var(--premium-blue);"></i>
        </div>
    </div>

    <div id="friends" class="tab-content">
        <h2 style="text-align:center;">Friends</h2>
        <p style="text-align:center; margin-top:50px; color:var(--gray);">Coming Soon...</p>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('home')"><i class="fas fa-home"></i><span>Home</span></div>
        <div class="nav-item" onclick="switchTab('friends')"><i class="fas fa-users"></i><span>Friends</span></div>
    </nav>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    const RANKS = {
        1: "Apprentice", 2: "Bronze", 3: "Bronze Plus", 4: "Silver", 5: "Silver Plus",
        6: "Gold", 7: "Gold Plus", 8: "Platinum", 9: "Platinum Plus", 10: "Diamond", 11: "Diamond"
    };

    let userData = { age: 1, points: 0, isPremium: false };

    function initData() {
        const user = tg.initDataUnsafe.user;
        if (!user) return;

        // YaÅŸ Hesaplama (Hata dÃ¼zeltilmiÅŸ mantÄ±k)
        const id = user.id;
        if (id < 50000000) userData.age = 11;
        else if (id < 150000000) userData.age = 10;
        else if (id < 450000000) userData.age = 8;
        else if (id < 1000000000) userData.age = 6;
        else if (id < 5000000000) userData.age = 3;
        else userData.age = 1;

        userData.isPremium = user.is_premium || false;
        userData.points = (userData.age * 450) + (userData.isPremium ? 1000 : 0);

        // UI Doldurma
        document.getElementById('intro-user-name').innerText = user.first_name;
        document.getElementById('u-name').innerText = user.first_name;
        document.getElementById('intro-age-text').innerText = userData.age + " Years";
        document.getElementById('acc-age').innerText = userData.age + " Years";
        document.getElementById('intro-points-text').innerText = userData.points;
        document.getElementById('total-flsy').innerText = userData.points.toLocaleString();
        
        const rankName = RANKS[userData.age] || "Apprentice";
        document.getElementById('intro-rank').innerText = rankName;
        document.getElementById('u-rank').innerText = rankName;
        if(userData.age >= 10) document.getElementById('u-rank').classList.add('rank-diamond');

        if(user.photo_url) {
            document.getElementById('intro-pic').src = user.photo_url;
            document.getElementById('u-pic').src = user.photo_url;
        }

        if(userData.isPremium) document.getElementById('prem-stat-box').style.display = 'flex';

        // Daha Ã¶nce girmiÅŸ mi kontrol et
        if (localStorage.getItem('flashy_onboarded')) {
            document.getElementById('intro-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'block';
        }
    }

    function showPremiumStep() {
        document.getElementById('intro-screen').style.display = 'none';
        const premScreen = document.getElementById('premium-status-screen');
        const icon = document.getElementById('prem-icon');
        const msg = document.getElementById('prem-msg');

        premScreen.style.display = 'flex';
        if (userData.isPremium) {
            icon.innerHTML = "ðŸŒŸ";
            msg.innerHTML = "You are a Premium user!<br>An extra +1,000 FLSY has been added to your balance.";
        } else {
            icon.innerHTML = "ðŸ‘¤";
            msg.innerHTML = "You do not have Telegram Premium.<br>No extra bonus points awarded.";
        }
        tg.HapticFeedback.impactOccurred('medium');
    }

    function finishIntro() {
        localStorage.setItem('flashy_onboarded', 'true');
        document.getElementById('premium-status-screen').style.display = 'none';
        document.getElementById('main-app').style.display = 'block';
        tg.HapticFeedback.notificationOccurred('success');
    }

    function switchTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(i => {
            i.classList.remove('active');
            if(i.innerText.toLowerCase() === tabId) i.classList.add('active');
        });
        tg.HapticFeedback.impactOccurred('light');
    }

    window.onload = initData;
</script>
</body>
</html>
