<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Flashy Farm & 3D Game</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --bg: #000000; --card: #121212; --accent: #fcd535; --text: #ffffff; --gray: #888888; --blue: #007aff; }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; outline: none; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; overflow: hidden; height: 100vh; }
        
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; position: relative; z-index: 100; pointer-events: none; }
        .user-info, .top-balance { pointer-events: auto; }
        .profile-pic { width: 35px; height: 35px; border-radius: 50%; border: 1px solid #444; overflow: hidden; }
        .profile-pic img { width: 100%; height: 100%; object-fit: cover; }
        .top-balance { background: var(--card); padding: 5px 12px; border-radius: 20px; border: 1px solid var(--accent); font-weight: bold; font-size: 0.9rem; display: flex; align-items: center; gap: 5px; }

        .container { height: calc(100vh - 140px); overflow-y: auto; padding: 10px 20px; }
        .page { display: none; height: 100%; }
        .page.active-page { display: block; }

        /* OYUN UI KATMANLARI */
        #game-container { position: relative; width: 100%; height: 100%; overflow: hidden; border-radius: 20px; background: #050505; }
        #game-ui-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; display: flex; flex-direction: column; align-items: center; }
        .game-stats { margin-top: 10px; font-weight: bold; color: var(--accent); font-size: 1.2rem; text-shadow: 2px 2px 4px #000; }
        
        .game-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 20; display: flex; flex-direction: column; align-items: center; justify-content: center; pointer-events: auto; }
        .hidden { display: none !important; }

        .btn-game { background: var(--accent); color: #000; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; margin: 5px; cursor: pointer; width: 200px; }
        .btn-shop { background: #333; color: #fff; }

        .nav-bar { position: fixed; bottom: 0; width: 100%; background: rgba(0,0,0,0.95); display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #222; backdrop-filter: blur(10px); z-index: 1000; }
        .nav-item { color: var(--gray); font-size: 0.65rem; display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer; }
        .nav-item.active { color: var(--accent); }
    </style>
</head>
<body>
    <div class="header">
        <div class="user-info">
            <div class="profile-pic"><img id="user-photo" src="https://cdn-icons-png.flaticon.com/512/149/149071.png"></div>
            <div id="user-name">Yükleniyor...</div>
        </div>
        <div class="top-balance">
            <img src="https://cdn.discordapp.com/attachments/539009365391441921/1465903677524017421/5769619140443311194_99.jpg" style="width:18px; border-radius:50%">
            <span id="top-balance-val">0</span>
        </div>
    </div>

    <div class="container">
        <div id="page-game" class="page active-page">
            <div id="game-container">
                <div id="game-ui-overlay">
                    <div class="game-stats">LEVEL: <span id="game-lvl">1</span> | SKOR: <span id="game-score">0</span></div>
                    
                    <div id="screen-main" class="game-screen">
                        <h2 style="color:var(--accent)">STACK BALL 3D</h2>
                        <button class="btn-game" onclick="startGame()">BAŞLAT</button>
                        <button class="btn-game btn-shop" onclick="openShop()">MAĞAZA</button>
                        <button class="btn-game btn-shop" onclick="toggleMute()" id="mute-btn">SES: AÇIK</button>
                    </div>

                    <div id="screen-shop" class="game-screen hidden">
                        <h3>SKIN MAĞAZASI</h3>
                        <div id="skin-list" style="display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-bottom:20px;"></div>
                        <button class="btn-game" onclick="closeShop()">GERİ</button>
                    </div>

                    <div id="screen-over" class="game-screen hidden">
                        <h2 id="over-title">OYUN BİTTİ</h2>
                        <p>Kazanılan Flashy: <span id="reward-amt" style="color:var(--accent)">0</span></p>
                        <button class="btn-game" onclick="alert('Reklam sistemi yakında!')">REKLAMLA DEVAM</button>
                        <button class="btn-game btn-shop" onclick="resetGame()">ANA MENÜ</button>
                    </div>
                </div>
                <div id="three-canvas-container"></div>
            </div>
        </div>

        </div>

    <div class="nav-bar">
        <div class="nav-item active" onclick="switchPage('game', this)"><i class="fas fa-gamepad"></i>OYUN</div>
        <div class="nav-item" onclick="switchPage('farm', this)"><i class="fas fa-tractor"></i>FARM</div>
        <div class="nav-item" onclick="switchPage('wallet', this)"><i class="fas fa-wallet"></i>CÜZDAN</div>
    </div>

    <script src="script.js"></script>
</body>
</html>
